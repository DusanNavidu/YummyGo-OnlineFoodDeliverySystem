<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partner Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Epunda+Slab:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/Style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.5/dist/leaflet.css" />
    <style>
        /* General card style */
        .card {border-radius: 12px;transition: transform 0.2s, box-shadow 0.2s;font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;line-height: 1.4;}
        .card:hover {transform: translateY(-3px);box-shadow: 0 8px 20px rgba(0,0,0,0.15);}
        /* Card header */
        .card-header {font-weight: 600;font-size: 0.95rem;border-bottom: 1px solid #e2e2e2;padding: 0.65rem 1rem;}
        /* Status badge */
        .card-header small {background-color: #ffc107;color: #212529;padding: 2px 8px;border-radius: 8px;font-weight: 500;}
        /* Card body */
        .card-body {padding: 1rem;}
        /* Card title */
        .card-title {font-size: 1.1rem;font-weight: 600;margin-bottom: 0.5rem;}
        /* Card text */
        .card-text {font-size: 0.9rem;color: #444;margin-bottom: 1rem;}
        /* Buttons */
        .btn-sm {font-size: 0.8rem;padding: 0.3rem 0.6rem;border-radius: 6px;transition: all 0.2s;}
        .btn-sm:hover {transform: scale(1.05);}
        /* Loading placeholders for locations */
        .business-location,
        .delivery-location {font-style: italic;color: #6c757d;}
        /* Alert messages */
        .alert {border-radius: 10px;}
        /* Optional: shadow for success border */
        .border-success {border-width: 2px !important;}
    </style>
</head>
<body class="position-relative">
    <nav id="placeholder-nav-bar" class="navbar navbar-expand-lg navbar-dark bg-dark position-fixed top-0 start-0 w-100 z-1">
        <div class="container-fluid">
            <a class="navbar-brand ps-2" href="#"><span class="fw-bold fs-3 text-light">YUMMY</span><span class="fs-3 fw-bold text-warning">GO</span> </a>
            <button id="profile-btn" class="btn"
                style="position: absolute; top: 7px; right: 70px;">
                <img class="img-fluid rounded-circle" style="width: 40px;" src="/assets/image/download (5).png" alt="User Profile">
            </button>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav" style="margin-right: 150px;">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link text-light" href="#">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/pages/orders.html">Orders</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-light" href="#">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-light" href="#">Contact</a>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-dark" id="logoutBtn">
                            Logout
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <button class="btn fs-5 fw-semibold font-family d-flex align-items-center" style="margin-top: 70px;"
     data-bs-toggle="modal" data-bs-target="#location-add-modal">
        <img src="/assets/logo/maps-and-flags.png" id="map-pin" alt="map pin image">
        <span id="current-location" class="pe-2"></span>
            Now location
    </button>

    <!-- Rider Introduction -->
    <button id="rider-introduction" class="btn btn-light border-black z-2" data-bs-toggle="modal" data-bs-target="#rider-Save-Modal"
        style="width:50px; height:50px; border-radius:50%; position:fixed; bottom:0; right:0; margin:20px;">
        <img src="/assets/logo/man.png" alt="rider-introduction btn" style="width:25px; height:25px;">
    </button>

    <!-- Rider save introduction container -->
    <div id="rider-save-introduction-container" class="container rounded-5 shadow p-5" style="margin-top:10px;">
        <div class="d-flex flex-column justify-content-end mb-2">
            <div class="d-flex justify-content-end">
                <button class="btn btn-primary" id="addRiderBtn" data-bs-toggle="modal" data-bs-target="#vehicle-Save-Modal">+ Add Vehicle (Partner)</button>
            </div>
            <h3>ðŸ“Œ Note for Riders:</h3>
            <p id="notice-paragraph">
                "Welcome to the vehicle addition section! Here, riders and partners can easily register their vehicles to the system,
                allowing them to participate in delivery or ride-sharing services efficiently. It is important to provide accurate and
                complete information to ensure smooth operation. Please start by selecting the correct vehicle category from the
                dropdown menu. If your vehicle is a bike, three-wheeler, or any other type, choose the appropriate option carefully.
                After selecting the category, fill in all required details such as the vehicle license number, vehicle number, and your
                personal ID number. For bicycles, license and vehicle numbers are not required, so the system will automatically handle
                this for you. Next, upload a clear image of your vehicle using the provided image upload section. You can either click
                to select a file or drag and drop it directly into the designated area. Make sure the image is clear and visible, as
                this will be used for verification purposes. Once all information is entered correctly and the image is uploaded, click
                the save button to submit your vehicle registration. After successful submission, you can manage or update your vehicle
                information from the dashboard at any time. Thank you for keeping your information accurate and up to date!
            </p>
        </div>
    </div>

    <div id="vehicle-status-container-btn" class="d-flex justify-content-center" style="margin-top: 100px; display: none;">
        <button id="statusToggleBtn" class="w-75 btn fs-3"
            style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;">
            Inactive
        </button>
    </div>

    <div id="ordersContainer" class="container mt-4"></div>

    <div class="modal fade" id="vehicle-Save-Modal" tabindex="-1" aria-labelledby="vehicle-Save-Modal-Label" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modal-lg">
                <div class="modal-header">
                    <h5 class="modal-title" id="vehicle-Save-Modal-Label">Vehicle Save</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="vehicleSaveForm">
                    <div class="modal-body">
                        <label for="vehicleCategory">Vehicle Category</label>
                        <select name="vehicleCategory" id="vehicleCategory" class="form-select mb-3" required>
                            <option value="" disabled selected>Select Vehicle Category</option>
                            <option>Bike</option>
                            <option>Bicycle</option>
                            <option>Three Wheeler</option>
                        </select>
                        <label for="vehicleLicenseNumber">Vehicle License Number</label>
                        <input type="text" id="vehicleLicenseNumber" name="vehicleLicenseNumber" class="form-control mb-3">
                        <label for="idNumber">ID Number</label>
                        <input type="text" id="idNumber" name="idNumber" class="form-control mb-3">
                        <label for="vehicleNumber">Vehicle Number</label>
                        <input type="text" id="vehicleNumber" name="vehicleNumber" class="form-control mb-3">
                        <label for="vehicleImage">Vehicle Image</label>
                        <div id="vehicleImageDropzone" class="border border-secondary rounded p-3 mb-3 text-center" style="cursor:pointer; position:relative;">
                            <p id="vehicleImageDropzoneText">Click or drag image here</p>
                            <input type="file" id="vehicleImage" name="vehicleImage" accept="image/*" style="opacity:0; position:absolute; top:0; left:0; width:100%; height:100%; cursor:pointer;">
                            <div id="vehicleImagePreview" class="mt-2"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Save Vehicle</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Location Modal -->
    <div class="modal fade mt-5" id="location-add-modal" tabindex="-1" aria-labelledby="location-add-modal-label" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="location-add-modal-label">Delivery Location</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="location-form">
                    <div class="modal-body">
                        <select id="location-select" class="form-select mb-3 border-black rounded-5">
                            <option>Select a district</option>
                            <option>Colombo</option>
                            <option>Gampaha</option>
                            <option>Kalutara</option>
                            <option>Kandy</option>
                            <option>Matale</option>
                            <option>Nuwara Eliya</option>
                            <option>Galle</option>
                            <option>Matara</option>
                            <option>Hambantota</option>
                            <option>Jaffna</option>
                            <option>Kilinochchi</option>
                            <option>Mannar</option>
                            <option>Mullaitivu</option>
                            <option>Vavuniya</option>
                            <option>Ampara</option>
                            <option>Batticaloa</option>
                            <option>Trincomalee</option>
                            <option>Anuradhapura</option>
                            <option>Polonnaruwa</option>
                            <option>Kurunegala</option>
                            <option>Puttalam</option>
                            <option>Badulla</option>
                            <option>Monaragala</option>
                            <option>Kegalle</option>
                            <option>Ratnapura</option>
                        </select>
                        <button type="button" id="save-location" class="btn btn-primary w-100 mb-3 btn-dark rounded-5">Save Location</button>
                        <h6>Saved Addresses</h6>
                        <div id="saved-locations"></div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/leaflet@1.9.5/dist/leaflet.js"></script>
    <script src="/js/partnerDashboard.js"></script>

    <script>
document.addEventListener("DOMContentLoaded", function () {
    const locationSelect = document.getElementById("location-select");
    const saveLocationBtn = document.getElementById("save-location");
    const savedLocationsDiv = document.getElementById("saved-locations");
    const currentLocationSpan = document.getElementById("current-location");

    let savedLocations = JSON.parse(sessionStorage.getItem("savedLocations")) || [];

    // Render saved locations
    function renderLocations() {
        savedLocationsDiv.innerHTML = "";
        savedLocations.forEach((loc, index) => {
            let div = document.createElement("div");
            div.className = "location-item d-flex justify-content-between align-items-center mb-1 p-1 border rounded";
            div.innerHTML = `
                <span class="location-name" data-index="${index}" style="cursor:pointer;">
                    <img src="/assets/logo/maps-and-flags.png" id="map-pin" alt="map pin image"> ${loc}
                </span> 
                <span class="delete-btn text-danger" data-index="${index}" style="cursor:pointer;">
                    <img src="/assets/logo/bin.png" id="map-pin" alt="map pin image">
                </span>`;
            savedLocationsDiv.appendChild(div);
        });

        // Delete buttons
        document.querySelectorAll(".delete-btn").forEach(btn => {
            btn.addEventListener("click", function () {
                let i = this.getAttribute("data-index");
                savedLocations.splice(i, 1);
                sessionStorage.setItem("savedLocations", JSON.stringify(savedLocations));
                renderLocations();
                if (savedLocations.length > 0) {
                    currentLocationSpan.innerText = savedLocations[savedLocations.length - 1];
                    location.reload();
                } else {
                    currentLocationSpan.innerText = "Now location";
                }
            });
        });

        // Click on location name â†’ set as last element & refresh
        document.querySelectorAll(".location-name").forEach(item => {
            item.addEventListener("click", function () {
                let index = this.getAttribute("data-index");
                let selectedLocation = savedLocations[index];
                savedLocations.splice(index, 1);
                savedLocations.push(selectedLocation);
                sessionStorage.setItem("savedLocations", JSON.stringify(savedLocations));

                currentLocationSpan.innerText = selectedLocation;

                let modal = bootstrap.Modal.getInstance(document.getElementById("location-add-modal"));
                modal.hide();

                location.reload();
            });
        });

        if (savedLocations.length > 0) {
            currentLocationSpan.innerText = savedLocations[savedLocations.length - 1];
        }
    }

    // Save location button
    saveLocationBtn.addEventListener("click", function () {
        let selectedLocation = locationSelect.value;
        if (selectedLocation !== "Select a district" && !savedLocations.includes(selectedLocation)) {
            savedLocations.push(selectedLocation);
            sessionStorage.setItem("savedLocations", JSON.stringify(savedLocations));
            renderLocations();
            location.reload();
        }
    });

    renderLocations();
});
</script>
</body>
</html>
